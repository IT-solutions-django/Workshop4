{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">

    <!-- Local files -->
    <link rel="stylesheet" href="{% static 'css/reset.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Libraries -->
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->
    <script src="{% static 'js/imask/Imask.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Swiper -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <!-- Logo -->
    <link rel=icon type=image/png sizes=16x16 href="{% static 'images/logo.svg' %}">

    <!-- Local files -->
    <script src="{% static 'js/header.js' %}" defer=""></script>

    <!-- Яндекс Карты -->
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    
    <title>{% block title %}{% endblock title %}</title>
    <meta name=description content="{% block description %}{% endblock %}">
    <meta property=og:title content="{% block meta_title %}{% endblock %}">
    <meta property=og:description content="{% block meta_description %}{% endblock %}">
    {% block head %}
    {% endblock %}


    <!-- FANDS -->
    <link rel="stylesheet" href="{% static 'css/service-page.css' %}">
    <script src="{% static 'js/service-page-open.js' %}" defer></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
    <header class="header">
        <div class="header__row">
            <div class="header__left-part">
              
                    <div class="header__logo only-desktop">
                        <a href="{% url 'home:home' %}" class="header__logo-link">
                            <img src="{% static 'images/logo.svg' %}" alt="Логотип">
                        </a>
                    </div>
              
                <a class="only-mobile header-mobile-logo">
                    <img src="{% static 'images/logo.svg' %}" alt="">
                </a>
                <div class="header__nav">
                    <div class="header__menu only-desktop">
                        <div class="header__menu-link">
                            <a class="red-hover" href="{% url 'home:home' %}">Главная</a>
                        </div>
                        <div class="header__menu-link">
                            <a class="red-hover" href="{% url 'services:services' %}">Услуги</a>
                        </div>
                        <div class="header__menu-link">
                            <a class="red-hover" href="{% url 'contacts:about_company' %}">О компании</a>
                        </div>
                        <div class="header__menu-link">
                            <a class="red-hover" href="{% url 'blog:blog' %}">Блог</a>
                        </div>
                        <!-- <div class="header__menu-link">
                            <a class="red-hover" href="">Контакты</a>
                        </div> -->
                    </div>
                </div>
            </div>
            <div class="header__right-part">
                <div class="header__right-part--phone">
                    <a target="_blank" href="tel:{{ company_info.phone }}">{{ company_info.phone }}</a>
                    <a target="_blank" class="label" href="{{ company_info.whatsapp_link }}">Whatsapp</a>
                </div>
                <button class="only-mobile burger-button">
                    <img src="{% static 'images/burger.svg' %}" alt="">
                </button>
                <button class="header__right-part--button only-desktop">
                    Связаться с нами
                </button>
            </div> 
            
            <div class="mobile-menu">
                <p class="mobile-menu-heading">Меню</p>
                <div class="mobile-menu-links">
                    <a href="{% url 'home:home' %}">Главная</a>
                    <a href="{% url 'services:services' %}">Услуги</a>
                    <a href="{% url 'contacts:about_company' %}">О компании</a>
                    <a href="{% url 'blog:blog' %}">Блог</a>
                    <!-- <a href="">Контакты</a> -->
                </div>
            </div>

        </div>
    </header>

    <div class="animated-heading-container container">
         <!-- <h1 class="animated-heading uppercase"></h1> -->
         <div class="header">
            <div class="breadcrumbs">
                <a href="{% url 'home:home' %}">Главная</a>
                <a href="{% url 'services:services' %}">Услуги</a>
            </div>
            <h1 class="page-heading"></h1>
        </div>
    </div>

    <div>

    </div>

    <main>
    {% block content %}
    {% endblock content %}
    </main>
    
    <footer>
        <div class="container">
            <div class="content">
                <div class="left-column">
                    <div class="address">
                        <p>{{ company_info.address }}</p>
                        <small>{{ company_info.work_hours }}</small>
                    </div>
                    <div class="footer-contacts">
                        <div class="phone-container">
                            <small>Телефон</small>
                            <a target="_blank" href="tel:{{ company_info.phone }}" class="phone">{{ company_info.phone }}</a>
                        </div>
                        <a target="_blank" href="mailto:{{ company_info.email }}" class="email">{{ company_info.email }}</a>
                        <div class="social-links">
                            <a target="_blank" href="{{ company_info.telegram_link }}">
                                <img src="{% static 'images/telegram.svg' %}" alt="">
                            </a>
                            <a target="_blank" href="{{ company_info.whatsapp_link }}">
                                <img src="{% static 'images/whatsapp.svg' %}" alt="">
                            </a>
                            <a target="_blank" href="{{ company_info.vk_link }}">
                                <img src="{% static 'images/vk.svg' %}" alt="">
                            </a>
                        </div>
                    </div>
                </div>
                <div class="right-column">
                    <div class="upper">
                        <div class="links-list">
                            <a class="hover-white" href="{% url 'home:home' %}">Главная</a>
                            <a class="hover-white" href="{% url 'services:services' %}">Услуги</a>
                            <a class="hover-white" href="{% url 'contacts:about_company' %}">О компании</a>
                            <a class="hover-white" href="{% url 'blog:blog' %}">Блог</a>
                            <!-- <a class="hover-white" href="">Контакты</a> -->
                        </div>
                        <div class="links-list">
                            <a target="_blank" class="hover-white" href="{{ company_info.whatsapp_link }}">Whatsapp</a>
                            <a target="_blank" class="hover-white" href="{{ company_info.vk_link }}">Вконтакте</a>
                            <a target="_blank" class="hover-white" href="{{ company_info.telegram_link }}">Телеграм</a>
                        </div>
                    </div>
                    <div class="lower">
                        © 2025, Общество с ограниченной ответственностью Конструкторское бюро "ЦЕХ№4"
                    </div>
                </div>
            </div>
            <a href="{% url 'home:home' %}" class="footer-logo">
                <img src="{% static 'images/sharp-logo.svg' %}" alt="">
            </a>
        </div>
    </footer>
</body>
</html>
</body>

{% block script %}
{% endblock script %}

<!-- Модальное окно -->
<script defer>
    document.addEventListener('DOMContentLoaded', () => {

        const modal = document.getElementById('modal');
        const modalSuccess = document.getElementById('modalSuccess');
        const closeModalButton = document.getElementById('closeModal');
        const closeSuccessModalButtons = document.querySelectorAll('.closeSuccessModal')
        const feedbackForm = document.getElementById('modalFeedbackForm');
        const formSection = document.getElementById('modal');
        const successSection = document.getElementById('modalSuccess');

        const messageField = document.getElementById("id_message"); 

        const openModalButtons = document.querySelectorAll('.openModal');


        openModalButtons.forEach((button) => {
            button.addEventListener('click', () => {
                modal.style.display = 'flex';
            });
        });

        closeModalButton.addEventListener('click', () => {
            modal.style.display = 'none';
            messageField.value = "";
        });
        closeSuccessModalButtons.forEach((button) => {
            button.addEventListener('click', () => {
                modalSuccess.style.display = 'none';
                messageField.value = "";
            });
        }) 

        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
                messageField.value = "";
            }
        });

        feedbackForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            formSection.style.display = 'none';
            successSection.style.display = 'flex';

            let q = new FormData(feedbackForm),
                o = document.querySelector('input[name="csrfmiddlewaretoken"]').value;
            feedbackForm.reset();

            try {
                let s = await fetch(`/api/save-request/`, {
                    method: "POST",
                    body: q,
                    headers: {
                        "X-CSRFToken": o
                    }
                });
                s.status
            } catch (n) {
                console.error("Ошибка запроса:", n)
            }
        });

        // Маска
        document.querySelectorAll('input[type="tel"]').forEach(input => {
            let phoneMask = IMask(input, { mask: "+{7} (000) 000-00-00" });

            function validatePhoneNumber() {
                let t = input.value.replace(/\D/g, "");
                return t.length < 11 ? (input.setCustomValidity("Необходимо минимум 11 цифр"), !1) : (input.setCustomValidity(""), !0);
            }

            input.addEventListener("input", validatePhoneNumber);
        });
    });

</script>

<!-- Меню-бургер -->
<script defer>
    const burgerButton = document.querySelector('.burger-button'); 
    const mobileMenu = document.querySelector('.mobile-menu');
    const burgerIcon = burgerButton.querySelector('img');
    const body = document.querySelector('body');
    const html = document.documentElement;
    
    const closeIcon = document.createElement('img');
    closeIcon.src = "{% static 'images/close-burger.svg' %}";
    closeIcon.alt = "Закрыть меню";
    closeIcon.classList.add('hidden');
    burgerButton.appendChild(closeIcon);

    burgerIcon.classList.add('visible');
    closeIcon.classList.add('hidden');

    burgerButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('active');

        if (mobileMenu.classList.contains('active')) {
            body.style.overflow = 'hidden';
            html.style.overflow = 'hidden';
            burgerIcon.classList.remove('visible');
            burgerIcon.classList.add('hidden');
            closeIcon.classList.remove('hidden');
            closeIcon.classList.add('visible');
        } else {
            body.style.overflow = '';
            html.style.overflow = '';
            burgerIcon.classList.remove('hidden');
            burgerIcon.classList.add('visible');
            closeIcon.classList.remove('visible');
            closeIcon.classList.add('hidden');
        }
    });
</script>

<!-- Маска для телефонов -->
<script defer>
    document.querySelectorAll('input[type="tel"]').forEach(input => {
            let phoneMask = IMask(input, { mask: "+{7} (000) 000-00-00" });

            function validatePhoneNumber() {
                let t = input.value.replace(/\D/g, "");
                return t.length < 11 ? (input.setCustomValidity("Необходимо минимум 11 цифр"), !1) : (input.setCustomValidity(""), !0);
            }

            input.addEventListener("input", validatePhoneNumber);
        });
</script>

</html>