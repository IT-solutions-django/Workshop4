{% extends 'base.html' %} 
{% load static %} 

{% block title %}Цех №4{% endblock title %}

{% block content %}
<!-- Odometer.js -->
<script defer src="{% static 'js/odometer/odometer.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/odometer-default-theme.css' %}" />
<!-- InView.js -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'js/inview/inview.js' %}"></script>

<img class="main-bg" src="{% static 'images/gray-lines-bg.svg' %}" alt="">

<!-- 3D-анимация -->
<script type="module" src="https://unpkg.com/@splinetool/viewer@1.9.82/build/spline-viewer.js"></script>
<!-- <spline-viewer 
    url="https://prod.spline.design/CbjMghYMPjn2LvAV/scene.splinecode"
    interaction="true"  
    auto-rotate="false"
>
</spline-viewer> -->

<script src="{% static 'js/welcome-logo.js' %}"></script>
<link rel="stylesheet" href="{% static 'css/welcome-logo.css' %}">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<!-- Блок-визитка -->
<section class="welcome-section container">

    <div class="welcome-logo-container-wrapper">
        <div class="welcome-logo-container">
            <div class="welcome-logo-container-inner">
                <img class="bg" src="{% static 'images/logo-bg.png' %}" alt="">
            
                <svg width="2082" height="882" viewBox="0 0 2082 882" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2028 90.2666C1844.26 90.151 1219.55 90.4865 1204.39 91.2695C1183.81 153.425 1163.48 215.67 1143.44 278.006C1155.73 314.684 1167.56 351.487 1178.92 388.412H1253.51V423.852C1269.4 423.852 1818.15 423.849 2028 423.848V1008H-83V-208H2028V90.2666ZM172.953 95.3232V424.73H369.291C369.246 424.428 369.361 424.197 369.637 424.04C389.067 440.12 408.77 455.773 428.745 471V95.3232H369.291V357.744H240.703V95.3232H172.953ZM740.535 96.0137C717.265 95.3231 693.99 95.0923 670.711 95.3223C703.474 150.415 736.427 205.432 769.57 260.372C745.813 299.414 722.193 338.547 698.71 377.771C698.364 393.422 698.249 409.076 698.364 424.73C712.589 424.956 726.761 424.726 740.881 424.04C761.908 388.706 783.108 353.486 804.482 318.381C825.537 353.888 846.854 389.222 868.431 424.385C891.479 424.96 914.522 424.846 937.563 424.04C905.016 369.37 872.288 314.813 839.395 260.372C865.547 216.865 891.707 173.358 917.86 129.852C918.496 128.792 918.842 127.641 918.897 126.398C915.814 116.228 912.585 106.1 909.219 96.0137C895.621 95.0932 882.029 95.0932 868.431 96.0137C846.979 131.373 825.661 166.823 804.482 202.363C782.993 167.028 761.677 131.578 740.535 96.0137ZM1054.26 90.9062C1029.95 90.0037 1005.58 89.7015 981.132 89.999V424.727H1049.26C1049.11 373.927 1049.26 323.128 1049.72 272.33C1065.93 322.869 1082.28 373.366 1098.77 423.819C1112.79 424.869 1126.87 425.02 1141.01 424.272C1144.71 413.581 1148.34 402.848 1151.91 392.07C1119.27 291.716 1086.72 191.327 1054.26 90.9062ZM639.6 95.668C578.072 95.3227 516.544 95.2069 455.016 95.3223V424.73H671.401V365.34H514.47V290.066H671.401V230.677H514.47V154.713H671.401C671.646 151.856 671.3 149.093 670.364 146.426C660.023 129.564 649.768 112.644 639.6 95.668ZM2028 90.2666C2057.48 90.2852 2075.61 90.3146 2078.05 90.3564C2096.1 147.04 2089.81 203.683 2108.14 260.282V330.252H2121.79V388.408H2108.14V423.848C2104.61 423.848 2074.69 423.847 2028 423.848V90.2666ZM1252.61 167.599C1253.52 221.664 1253.82 275.882 1253.52 330.255C1235.61 330.557 1217.73 330.254 1199.84 329.346C1217.62 275.475 1235.2 221.559 1252.61 167.599Z" fill="#333333"/>
                </svg>
            </div>
        </div>
    </div>


    <div class="welcome-header">
        <h1>Обследование<br>и проектирование зданий</h1>
        <p class="section-description">Обеспечиваем высокий уровень качества, безопасности<br> и надежности на каждом этапе работы</p>
        <button class="red-button">Связаться с нами</button>
    </div>
</section>

<!-- Преимущества -->
<section class="advantages-section container">
    <div class="advantages-header">
        <div class="advantages-subheader">
            <div class="red-point-container">
                <div class="red-point"></div>
            </div>
            <p class="uppercase">Почему выбирают нас</p>
        </div>
        <div class="advantages-header-body">
            <h2>Надежные решения <br>
                для вашего строительства <br>
                и проектирования</h2>
            <p class="section-description">Профессиональный подход, современные технологии и гарантированное качество <br>
                для реализации ваших строительных проектов</p>
        </div>
    </div>
    <div class="advantages-stats">
        <div class="label">
            Наши преимущества
        </div>
        <div class="advantages-stats-container">
            <div class="advantages-stat">
                <p class="heading"><span class="odometer" id="projects-count">0</span>+</p>
                <p class="label">завершенных проектов</p>
            </div>
            <div class="advantages-stat">
                <p class="heading"><span class="odometer" id="area-count">0</span> тыс+ </p>
                <p class="label">м² площадь спроектированных объектов</p>
            </div>
            <div class="advantages-stat">
                <p class="heading"><span class="odometer" id="bim-count">0</span> %</p>
                <p class="label">проектов, выполненных с BIM-моделированием </p>
            </div>
        </div>
    </div>
</section>

<!-- Услуги -->
<section class="services-section container">
    <div class="services-header">
        <h2 class="section-heading">Наши услуги</h2>
        <p>Создаем надежные и эффективные<br>инженерные решения</p>
    </div>
    <div class="services-container box">
        <div class="header box">
            <div class="box-header">
                <span class="badge">От ТЗ до сдачи документации</span>
                <p class="box-heading">Проектирование <br>конструктивных решений</p>
            </div>
            <div class="tags">
                <div class="tag-row">
                    <span class="tag">Проектирование</span>
                    <span class="tag">Конструкторская документация</span>
                    <span class="tag">Обследование зданий</span>
                </div>
                <div class="tag-row">
                    <span class="tag">Анализ прочности</span>
                    <span class="tag">Технический аудит</span>
                    <span class="tag">Инженерные расчёты</span>
                    <span class="tag">Проектирование</span>
                </div>
            </div>
        </div>
      
        <div class="expertise box">
            <img src="{% static 'images/services-expertise.png' %}" alt="Экспертиза">
            <div class="box-text">
              <p class="box-heading">Экспертиза</p>
              <p>Оборудование<br>Сертификаты</p>
            </div>
        </div>
      
        <div class="survey box">
            <img src="{% static 'images/services-survey.png' %}" alt="Обследование">
            <div class="box-text">
              <p class="box-heading">Обследование зданий</p>
              <p>Визуальный осмотр, инструментальная диагностика, анализ грунтов</p>
            </div>
        </div>
      
        <div class="support box">
            <img src="{% static 'images/services-support.png' %}" alt="Сопровождение">
            <div class="box-text">
                <p class="box-heading">Сопровождение <br> проектов</p>
                <p class="box-gray">Согласование с госорганами, авторский <br> надзор, корректировка документации</p>
            </div>
        </div>
      
        <div class="quote box swiper">
            <div class="swiper-wrapper">
                {% for quote in quotes %}
                    <div class="quote-wrapper swiper-slide">
                        <p class="quote-text">"{{ quote.text }}"</p>
                        <div class="quote-info">
                        <img class="quote-author" src="{{ quote.author_photo.url }}" alt="Автор">
                        <div class="quote-author-info">
                            <p>{{ quote.author_name }}</p>
                            <small>{{ quote.author_position }}</small>
                        </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="swiper-quotes-prev">
                <img src="{% static 'images/left-arrow.svg' %}" alt="">
            </div>
            <div class="swiper-quotes-next">
                <img src="{% static 'images/right-arrow.svg' %}" alt="">
            </div>
        </div>
    </div>
</section>

{% include 'home/includes/contact_section.html' %}

{% include 'home/includes/partners_section.html' %}

<!-- Галерея -->
<section class="gallery-section container">
    <p class="section-heading container">Галерея работ</p>
    <div class="gallery-body">
        <div class="filter-panel container">
            <a class="active">Все направления</a>
            {% for category in categories %}
                <a href="{{ category.get_absolute_url }}">{{ category.name }}</a>
            {% endfor %}
        </div>
        <div class="gallery-slider swiper">
            <div class="swiper-wrapper">
                {% for article in articles %}
                    <a href="{{ article.get_absolute_url }}" class="gallery-photo swiper-slide">
                        <img src="{{ article.image.url }}" alt="">
                        <div class="badge">{{ article.created_at|date:"F Y" }}</div>
                        <p class="gallery-heading">{{ article.name }}</p>
                        <p class="gallery-label">{{ article.subtitle }}</p>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<!-- Карта -->
<section class="map-section">
    <div id="map"></div>
    <div class="map-section-content-container container">
        <div class="map-section-content">
            <div class="left-column">
                <p class="header">Контакты</p>
                <div class="body">
                    <div class="address">
                        <p class="label">Адрес</p>
                        <div class="value-container">
                            <p class="value">{{ company_info.address }}</p>
                            <small>{{ company_info.work_hours }}</small>
                        </div>
                    </div>
                    <div class="phone">
                        <p class="label">Телефон</p>
                        <a target="_blank" target="_blank" class="value" href="tel:{{ company_info.phone }}">{{ company_info.phone }}</a>
                    </div>
                    <a target="_blank" class="email" href="mailto:{{ company_info.email }}">{{ company_info.email }}</a>
                    <div class="social-links">
                        <a target="_blank" href="{{ company_info.telegram_link }}">
                            <img src="{% static 'images/telegram.svg' %}" alt="">
                        </a>
                        <a target="_blank" href="{{ company_info.whatsapp_link }}">
                            <img src="{% static 'images/whatsapp.svg' %}" alt="">
                        </a>
                        <a target="_blank" href="{{ company_info.vk_link }}">
                            <img src="{% static 'images/vk.svg' %}" alt="">
                        </a>
                    </div>
                </div>
            </div>
            <form class="right-column">
                {% csrf_token %}
                <p class="form-heading">Оставьте свою заявку и наш менеджер свяжется с Вами для уточнения деталей</p>
                <div class="inputs-panel">
                    <input type="text" required name="name" placeholder="Имя">
                    <input type="tel" required name="phone" placeholder="Телефон">
                </div>
                <textarea name="message" placeholder="Сообщение"></textarea>
                <div class="button-container">
                    <button class="red-button">Связаться с нами</button>
                    <p class="agreement-text">Нажимая "Связаться с нами", вы соглашаетесь на обработку персональных данных.</p>
                </div>
            </form>
        </div>
    </div>
</section>

{% endblock %}

{% block script %}

<script defer>
const quotesSwiper = new Swiper('.quote.swiper', {
    spaceBetween: 1,
    spaceBetween: 36,
    navigation: {
        nextEl: '.swiper-quotes-next',
        prevEl: '.swiper-quotes-prev',
    },
    pagination: {
        el: '.swiper-pagination',
        clickable: true,
    },
    breakpoints: {
        768: {
        slidesPerView: 1,
        },
        1024: {
        slidesPerView: 1,
        }
    }
    });
</script>

<!-- Карта -->
<script defer>
    var myMap;

    ymaps.ready((function() {
    myMap = new ymaps.Map("map", {
        center: [43.115542, 131.885494],
        zoom: 13,
        controls: []
    });
    var o = new ymaps.control.ZoomControl({
        options: {
            position: {
                right: 10,
                top: 50
            },
            size: "small"
        }
    });
    myMap.controls.add(o), myMap.behaviors.disable("scrollZoom");
    var a = new ymaps.Placemark([43.157062, 131.926061], {
        hintContent: "Волгоградская улица, 7А",
        balloonContent: "Волгоградская улица, 7А"
    }, {
        iconLayout: "default#image",
        iconImageHref: "/static/images/pin.svg",
        iconImageSize: [30, 42],
        iconImageOffset: [-15, -42]
    });
    myMap.geoObjects.add(a)
}));
</script>

<script defer>
const mapForm = document.querySelector('.map-section form');
mapForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(mapForm);

    try {
        const response = await axios.post('/contacts/api/save-request/', formData);
        
        if (response.data.success) {
            mapForm.reset();
        }
    } catch (error) {
        console.error('Ошибка при отправке формы:', error);
    }
});
</script>

<!-- Логотип в шапке -->
<script defer>
    const welcomeLogo = document.querySelector('.welcome-logo');
    const headerLogo = document.querySelector('header .header__logo'); 
    const headerMenu = document.querySelector('header .header__menu');

    console.log(headerLogo)

    window.addEventListener('scroll', () => {
        const welcomeLogoBottom = welcomeLogo.getBoundingClientRect().bottom;
        
        if (welcomeLogoBottom <= 0) {
            headerLogo.classList.add('visible');
            headerMenu.classList.add('visible');
            console.log('прошли')
        } else {
            headerLogo.classList.remove('visible');
            headerMenu.classList.remove('visible');
        }
    });
</script>


<script defer>
    // Анимации
document.addEventListener('DOMContentLoaded', () => {
    let projectsCount = document.querySelector('#projects-count'); 
    let areaCount = document.querySelector('#area-count');
    let bimCount = document.querySelector('#bim-count'); 

    console.log(projectsCount)


    function runStatsAnimation() {
        projectsCount.innerHTML = 150;
        areaCount.innerHTML = 500; 
        bimCount.innerHTML = 100; 
    }

    inView('.advantages-stats-container').once('enter', runStatsAnimation);
});
</script>

{% endblock %}