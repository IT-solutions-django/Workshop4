{% extends 'base.html' %} 
{% load static %} 

{% block title %}Цех №4{% endblock title %}

{% block content %}
<img class="main-bg" src="{% static 'images/gray-lines-bg.svg' %}" alt="">

<!-- 3D-анимация -->
<script type="module" src="https://unpkg.com/@splinetool/viewer@1.9.82/build/spline-viewer.js"></script>
<spline-viewer 
    url="https://prod.spline.design/CbjMghYMPjn2LvAV/scene.splinecode"
    interaction="true"  
    auto-rotate="false"
>
</spline-viewer>

<!-- Блок-визитка -->
<section class="welcome-section container">
    <div class="welcome-logo">
        <img src="{% static 'images/logo.svg' %}" alt="">
    </div>
    <div class="welcome-header">
        <h1>Обследование<br>и проектирование зданий</h1>
        <p class="section-description">Обеспечиваем высокий уровень качества, безопасности<br> и надежности на каждом этапе работы</p>
        <button class="red-button">Связаться с нами</button>
    </div>
</section>

<!-- Преимущества -->
<section class="advantages-section container">
    <div class="advantages-header">
        <div class="advantages-subheader">
            <div class="red-point-container">
                <div class="red-point"></div>
            </div>
            <p class="uppercase">Почему выбирают нас</p>
        </div>
        <div class="advantages-header-body">
            <h2>Надежные решения <br>
                для вашего строительства <br>
                и проектирования</h2>
            <p class="section-description">Профессиональный подход, современные технологии и гарантированное качество <br>
                для реализации ваших строительных проектов</p>
        </div>
    </div>
    <div class="advantages-stats">
        <div class="label">
            Наши преимущества
        </div>
        <div class="advantages-stats-container">
            <div class="advantages-stat">
                <p class="heading">150+</p>
                <p class="label">завершенных проектов</p>
            </div>
            <div class="advantages-stat">
                <p class="heading">500 тыс+ </p>
                <p class="label">м² площадь спроектированных объектов</p>
            </div>
            <div class="advantages-stat">
                <p class="heading">до 100%</p>
                <p class="label">проектов, выполненных с BIM-моделированием </p>
            </div>
        </div>
    </div>
</section>

<!-- Услуги -->
<section class="services-section container">
    <div class="services-header">
        <h2 class="section-heading">Наши услуги</h2>
        <p>Создаем надежные и эффективные<br>инженерные решения</p>
    </div>
    <div class="services-container box">
        <div class="header box">
            <div class="box-header">
                <span class="badge">От ТЗ до сдачи документации</span>
                <p class="box-heading">Проектирование <br>конструктивных решений</p>
            </div>
            <div class="tags">
                <div class="tag-row">
                    <span class="tag">Проектирование</span>
                    <span class="tag">Конструкторская документация</span>
                    <span class="tag">Обследование зданий</span>
                </div>
                <div class="tag-row">
                    <span class="tag">Анализ прочности</span>
                    <span class="tag">Технический аудит</span>
                    <span class="tag">Инженерные расчёты</span>
                    <span class="tag">Проектирование</span>
                </div>
            </div>
        </div>
      
        <div class="expertise box">
            <img src="{% static 'images/services-expertise.png' %}" alt="Экспертиза">
            <div class="box-text">
              <p class="box-heading">Экспертиза</p>
              <p>Оборудование<br>Сертификаты</p>
            </div>
        </div>
      
        <div class="survey box">
            <img src="{% static 'images/services-survey.png' %}" alt="Обследование">
            <div class="box-text">
              <p class="box-heading">Обследование зданий</p>
              <p>Визуальный осмотр, инструментальная диагностика, анализ грунтов</p>
            </div>
        </div>
      
        <div class="support box">
            <img src="{% static 'images/services-support.png' %}" alt="Сопровождение">
            <div class="box-text">
                <p class="box-heading">Сопровождение <br> проектов</p>
                <p class="box-gray">Согласование с госорганами, авторский <br> надзор, корректировка документации</p>
            </div>
        </div>
      
        <div class="quote box swiper">
            <div class="swiper-wrapper">
                {% for quote in quotes %}
                    <div class="quote-wrapper swiper-slide">
                        <p class="quote-text">"{{ quote.text }}"</p>
                        <div class="quote-info">
                        <img class="quote-author" src="{{ quote.author_photo.url }}" alt="Автор">
                        <div class="quote-author-info">
                            <p>{{ quote.author_name }}</p>
                            <small>{{ quote.author_position }}</small>
                        </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="swiper-quotes-prev">
                <img src="{% static 'images/left-arrow.svg' %}" alt="">
            </div>
            <div class="swiper-quotes-next">
                <img src="{% static 'images/right-arrow.svg' %}" alt="">
            </div>
        </div>
    </div>
</section>

{% include 'home/includes/contact_section.html' %}

{% include 'home/includes/partners_section.html' %}

<!-- Галерея -->
<section class="gallery-section container">
    <p class="section-heading container">Галерея работ</p>
    <div class="gallery-body">
        <div class="filter-panel container">
            <a class="active">Все направления</a>
            {% for category in categories %}
                <a href="{{ category.get_absolute_url }}">{{ category.name }}</a>
            {% endfor %}
        </div>
        <div class="gallery-slider swiper">
            <div class="swiper-wrapper">
                {% for article in articles %}
                    <a href="{{ article.get_absolute_url }}" class="gallery-photo swiper-slide">
                        <img src="{{ article.image.url }}" alt="">
                        <div class="badge">{{ article.created_at|date:"F Y" }}</div>
                        <p class="gallery-heading">{{ article.name }}</p>
                        <p class="gallery-label">{{ article.subtitle }}</p>
                    </a>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<!-- Карта -->
<section class="map-section">
    <div id="map"></div>
    <div class="map-section-content-container container">
        <div class="map-section-content">
            <div class="left-column">
                <p class="header">Контакты</p>
                <div class="body">
                    <div class="address">
                        <p class="label">Адрес</p>
                        <div class="value-container">
                            <p class="value">{{ company_info.address }}</p>
                            <small>{{ company_info.work_hours }}</small>
                        </div>
                    </div>
                    <div class="phone">
                        <p class="label">Телефон</p>
                        <a target="_blank" target="_blank" class="value" href="tel:{{ company_info.phone }}">{{ company_info.phone }}</a>
                    </div>
                    <a target="_blank" class="email" href="mailto:{{ company_info.email }}">{{ company_info.email }}</a>
                    <div class="social-links">
                        <a target="_blank" href="{{ company_info.telegram_link }}">
                            <img src="{% static 'images/telegram.svg' %}" alt="">
                        </a>
                        <a target="_blank" href="{{ company_info.whatsapp_link }}">
                            <img src="{% static 'images/whatsapp.svg' %}" alt="">
                        </a>
                        <a target="_blank" href="{{ company_info.vk_link }}">
                            <img src="{% static 'images/vk.svg' %}" alt="">
                        </a>
                    </div>
                </div>
            </div>
            <form class="right-column">
                {% csrf_token %}
                <p class="form-heading">Оставьте свою заявку и наш менеджер свяжется с Вами для уточнения деталей</p>
                <div class="inputs-panel">
                    <input type="text" required name="name" placeholder="Имя">
                    <input type="tel" required name="phone" placeholder="Телефон">
                </div>
                <textarea name="message" placeholder="Сообщение"></textarea>
                <div class="button-container">
                    <button class="red-button">Связаться с нами</button>
                    <p class="agreement-text">Нажимая "Связаться с нами", вы соглашаетесь на обработку персональных данных.</p>
                </div>
            </form>
        </div>
    </div>
</section>

{% endblock %}

{% block script %}

<!-- Галерея -->
<script defer>
    const gallerySwiper = new Swiper('.gallery-slider.swiper', {
        spaceBetween: 24,
        initialSlide: 0,
        slidesOffsetBefore: 12,
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
        },
        breakpoints: {
          0: {
            slidesPerView: 1.2,
            spaceBetween: 12,
          },
          768: {
            slidesPerView: 1.2,
            spaceBetween: 24,
          },
          1024: {
            slidesPerView: 3,
            spaceBetween: 24,
          }
        }
      });
</script>

<script defer>
const quotesSwiper = new Swiper('.quote.swiper', {
    spaceBetween: 1,
    spaceBetween: 36,
    navigation: {
        nextEl: '.swiper-quotes-next',
        prevEl: '.swiper-quotes-prev',
    },
    pagination: {
        el: '.swiper-pagination',
        clickable: true,
    },
    breakpoints: {
        768: {
        slidesPerView: 1,
        },
        1024: {
        slidesPerView: 1,
        }
    }
    });
</script>

<!-- Карта -->
<script defer>
    var myMap;

    ymaps.ready((function() {
    myMap = new ymaps.Map("map", {
        center: [43.115542, 131.885494],
        zoom: 13,
        controls: []
    });
    var o = new ymaps.control.ZoomControl({
        options: {
            position: {
                right: 10,
                top: 50
            },
            size: "small"
        }
    });
    myMap.controls.add(o), myMap.behaviors.disable("scrollZoom");
    var a = new ymaps.Placemark([43.157062, 131.926061], {
        hintContent: "Волгоградская улица, 7А",
        balloonContent: "Волгоградская улица, 7А"
    }, {
        iconLayout: "default#image",
        iconImageHref: "/static/images/pin.svg",
        iconImageSize: [30, 42],
        iconImageOffset: [-15, -42]
    });
    myMap.geoObjects.add(a)
}));
</script>

<script defer>
const mapForm = document.querySelector('.map-section form');
mapForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData(mapForm);

    try {
        const response = await axios.post('/contacts/api/save-request/', formData);
        
        if (response.data.success) {
            mapForm.reset();
        }
    } catch (error) {
        console.error('Ошибка при отправке формы:', error);
    }
});
</script>
{% endblock %}